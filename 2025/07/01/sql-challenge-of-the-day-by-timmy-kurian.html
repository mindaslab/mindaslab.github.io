<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>SQL challenge of the day, by Timmy Kurian | Karthikeyan A Kâ€™s blog</title>
<meta name="generator" content="Jekyll v4.3.3" />
<meta property="og:title" content="SQL challenge of the day, by Timmy Kurian" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Lifted from: Timmy Kurianâ€™s Linkedin" />
<meta property="og:description" content="Lifted from: Timmy Kurianâ€™s Linkedin" />
<link rel="canonical" href="/2025/07/01/sql-challenge-of-the-day-by-timmy-kurian.html" />
<meta property="og:url" content="/2025/07/01/sql-challenge-of-the-day-by-timmy-kurian.html" />
<meta property="og:site_name" content="Karthikeyan A Kâ€™s blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-07-01T00:00:00+05:30" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="SQL challenge of the day, by Timmy Kurian" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2025-07-01T00:00:00+05:30","datePublished":"2025-07-01T00:00:00+05:30","description":"Lifted from: Timmy Kurianâ€™s Linkedin","headline":"SQL challenge of the day, by Timmy Kurian","mainEntityOfPage":{"@type":"WebPage","@id":"/2025/07/01/sql-challenge-of-the-day-by-timmy-kurian.html"},"url":"/2025/07/01/sql-challenge-of-the-day-by-timmy-kurian.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="/feed.xml" title="Karthikeyan A K's blog" /><script type="text/javascript" async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async>
  </script>

<style media="screen">
  /* responsive videos */
  .video figure {
    position: relative;
    padding-bottom: 56.25%;
    height: 0;
    overflow: hidden;
  }

  .video iframe, .video object, .video embed {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
  }

  .pagination{
    margin-top: 40px;
  }

  a.paginate {
    background-color: #4CAF50;
    color: white;
    padding: 8px 16px;
  }


  .darkmode--activated .site-title, .darkmode--activated .page-link{
    color: white;
  }

  @media only screen and (min-width: 600px){
    .darkmode--activated .page-link {
      color: white;
    }
  }

  @media only screen and (max-width: 600px){
    .darkmode--activated .page-link{
      color: black;
    }
  }

  .darkmode--activated video {
    filter: invert(0%);
  }

  .darkmode--activated .twitter-tweet{
    filter: invert(0%);
  }

  .darkmode--activated .MJXc-display{
    color: white !important;
  }

  .darkmode--activated .MathJax_CHTML{
    color: white !important;
  }

  
</style>

  <link rel="icon" type="image/x-icon" href="https://ia600308.us.archive.org/3/items/ak-logo-3/AK%20Logo%203.svg">
  <script src="https://cdn.jsdelivr.net/npm/darkmode-js@1.5.7/lib/darkmode-js.min.js"></script>
  <script>
    function addDarkmodeWidget() {
      const options = {
        label: 'ðŸŒ“'
      }

      new Darkmode(options).showWidget();
    }
    window.addEventListener('load', addDarkmodeWidget);
  </script>
</head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Karthikeyan A K&#39;s blog</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">Karthikeyan A K</a><a class="page-link" href="/categories/">Categories</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">SQL challenge of the day, by Timmy Kurian</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2025-07-01T00:00:00+05:30" itemprop="datePublished">Jul 1, 2025
      </time></p>
  </header>

  <div class="post-categories">
    
    
  </div>
  <p></p>
  <div class="post-content">
    <p>Lifted from: <a href="https://www.linkedin.com/posts/timy-kurian-88597526_sqlchallenge-sqlinterview-dataengineering-activity-7345515706592972801-rioo?utm_source=share&amp;utm_medium=member_desktop&amp;rcm=ACoAAArx5IoBZ1QlV3uo-mV_zNQXTgm4ETiUIeA">Timmy Kurianâ€™s Linkedin</a></p>

<p><strong>Problem:</strong></p>

<p>Given a table of customer purchases, write a query to calculate the running total of the total purchase amount for each customer, sorted in descending order by the running total.</p>

<figure class="highlight"><pre><code class="language-sql" data-lang="sql"><span class="n">Sample</span> <span class="n">Tables</span> <span class="p">(</span><span class="k">CREATE</span> <span class="o">+</span> <span class="k">INSERT</span><span class="p">):</span>
<span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">purchases</span> <span class="p">(</span>
 <span class="n">customer_id</span> <span class="nb">INT</span><span class="p">,</span>
 <span class="n">purchase_id</span> <span class="nb">INT</span><span class="p">,</span>
 <span class="n">purchase_amount</span> <span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span>
 <span class="n">purchase_date</span> <span class="nb">DATE</span>
<span class="p">);</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-sql" data-lang="sql"><span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">purchases</span> <span class="p">(</span><span class="n">customer_id</span><span class="p">,</span> <span class="n">purchase_id</span><span class="p">,</span> <span class="n">purchase_amount</span><span class="p">,</span> <span class="n">purchase_date</span><span class="p">)</span>
<span class="k">VALUES</span>
 <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">50</span><span class="p">.</span><span class="mi">00</span><span class="p">,</span> <span class="s1">'2020-01-01'</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">75</span><span class="p">.</span><span class="mi">00</span><span class="p">,</span> <span class="s1">'2020-01-05'</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">100</span><span class="p">.</span><span class="mi">00</span><span class="p">,</span> <span class="s1">'2020-01-10'</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">25</span><span class="p">.</span><span class="mi">00</span><span class="p">,</span> <span class="s1">'2020-01-15'</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">200</span><span class="p">.</span><span class="mi">00</span><span class="p">,</span> <span class="s1">'2020-01-20'</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">50</span><span class="p">.</span><span class="mi">00</span><span class="p">,</span> <span class="s1">'2020-01-25'</span><span class="p">);</span></code></pre></figure>

<p><strong>Query:</strong></p>

<figure class="highlight"><pre><code class="language-sql" data-lang="sql"><span class="k">SELECT</span>
 <span class="n">customer_id</span><span class="p">,</span>
 <span class="n">purchase_id</span><span class="p">,</span>
 <span class="n">purchase_amount</span><span class="p">,</span>
 <span class="k">SUM</span><span class="p">(</span><span class="n">purchase_amount</span><span class="p">)</span> <span class="n">OVER</span> <span class="p">(</span><span class="k">PARTITION</span> <span class="k">BY</span> <span class="n">customer_id</span> <span class="k">ORDER</span> <span class="k">BY</span> <span class="n">purchase_date</span> <span class="k">DESC</span><span class="p">)</span> <span class="k">AS</span> <span class="n">running_total</span>
<span class="k">FROM</span> <span class="n">purchases</span>
<span class="k">ORDER</span> <span class="k">BY</span> <span class="n">running_total</span> <span class="k">DESC</span><span class="p">;</span></code></pre></figure>

<p><strong>Explanation:</strong></p>

<p>This query uses the window function <code class="language-plaintext highlighter-rouge">SUM()</code> and <code class="language-plaintext highlighter-rouge">OVER()</code> to calculate the running total of the purchase amounts for each customer, sorted in descending order by the purchase date. This allows us to see the total amount spent by each customer over time. The <code class="language-plaintext highlighter-rouge">PARTITION</code> BY clause ensures that the running total is calculated separately for each customer. Finally, the <code class="language-plaintext highlighter-rouge">ORDER BY</code> clause sorts the results in descending order by the running total. This query can be useful for analyzing customer spending patterns and identifying top customers.</p>

  </div>

</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Karthikeyan A K&#39;s blog</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Karthikeyan A K&#39;s blog</li><li><a class="u-email" href="mailto:mindaslab@protonmail.com">mindaslab@protonmail.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Hello World, I am Karthikeyan. I eat briyani and worship Boomthata, the creator of God and Satan.
</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
